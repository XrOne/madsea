---
description: Règles spécifiques pour les composants Madsea
globs: ["backend/**/*.py", "frontend/**/*.{js,jsx,ts,tsx}"]
---

## Backend (Python/FastAPI)
- Service `extraction`: Extraire images+texte des PDFs avec PyMuPDF/Tesseract
- Service `comfyui_bridge`: Intégrer avec ComfyUI API (http://localhost:8188)
- Service `file_manager`: Standardiser noms de fichiers selon pattern E{episode}_SQ{sequence}-{plan}_{task}_v{version}.{ext}
- API RESTful: Endpoints JSON pour projets, épisodes, séquences, styles

## Frontend (React/TailwindCSS)
- Components: `SceneToolbar`, `SceneDetail`, `StyleSelector`, `PDFUploader`
- UX: Simplicité maximale, prévisualisations, feedback visuel constant
- Workflow: Import PDF → Extraction → Sélection style → Génération → Export

## Intégration ComfyUI
- Workflows: Utiliser ControlNet pour respecter la composition
- Styles: Basés sur LoRA ou TextualInversion pour silhouettes et autres styles
- Connecter via API websocket et file système partagé
- Traiter les générations par lots (batch processing)

## Tests et validation
- Tester chaque extraction PDF séparément
- Valider visuellement les images générées
- Vérifier nomenclature des fichiers générés
- Interface intuitive pour utilisateurs non-techniques